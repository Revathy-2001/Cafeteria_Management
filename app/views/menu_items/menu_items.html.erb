<div class = "MenuItems_page">
  <div class="SideNav_categories">
    <% MenuCategory.show_available_category.each do |category| %>
        <p id="Categories_link"> <%= link_to  category.name,show_menu_items_path(id: "#{category.id}"),
        class:"SideNave_categories_link"%></p>
    <% end %>
  </div>

  <div class = "MenuItem_cards_section">
    <% if(MenuItem.show_menu_item(@id).empty?)%>
        <div class = "No_menu_items">
           <%= image_tag("no_items.png",style:"width:300px")%>
           <p class = "No_items_message">No items are currently available</p>
        </div>
    <% else %>
        <% MenuItem.show_menu_item(@id).all.each do |item|  %>
          <section class = "MenuItems_cards">
            <div class="MenuItems_cards-content">
              <p class = "Item_name"><%= item.name %></p>
              <div class="MenuItem_details">
                <div class = "Item_price">&#8377;<%= item.price%></div>
                    <% if(item.status == "Active") %>
                      <%= link_to "Add",carts_path(id: "#{item.id}"),method:"post",class: "Add_item" %>
                    <% else %>
                      <button class= "Add_item_unavailable" disabled>Unavailable</button>
                    <% end %>
                </div>
              </div>
          </section>
        <% end %>
    <% end %>
</div>


  <div class="Cart_Section">
        <p class = "cart_title">Cart</p>
        <% cart = Cart.find_by(user_id: @current_user.id) %>
        <% if(cart.cart_items.empty?) %>
          <%= image_tag "emptycart.png",class: "EmptyCart_img" %>
          <p class = "EmptyCart_msg">Your cart is Empty<br>Looks like you haven't added anything to your cart yet.</p>
        <%else%>
           <div class = "CartItems_block">
              <% cart.cart_items.each do |cart_item| %>
                <div class = "CartItems_single">
                    <div class = "CartItem_firstrow">

                        <div class = "CartItem_firstrow_left">
                            <%= form_with(url: "/cart_items/#{cart_item.id}", method: "delete") do %>
                                  <%= image_submit_tag "deleteimage.png", class: "Close_cart_item" %>
                            <% end %>
                            <p><%= cart_item.menu_item_name %></p>
                        </div>

                        <div class = "CartAdd_btn">
                            <%= form_with(url: "/update_quantity/#{"add"}/#{cart_item.id}", method: "post") do %>
                                <%= submit_tag "+", class: "PlusButton"%>
                            <% end %>
                            <p class = "cart_quantity"><%= cart_item.quantity %></p>
                            <%= form_with(url: "/update_quantity/#{"sub"}/#{cart_item.id}", method: "post") do %>
                                <%= submit_tag "-", class: "MinusButton"%>
                            <% end %>
                        </div>
                    </div>
                    <p id = "price<%=cart_item.id%>" class = "cart_price">&#8377;<%= cart_item.temp_price %></p>
                </div>
              <%end %>
              <div class = "cart_footer">
                  <div  class = "Cart_subtotal">
                    <p> Subtotal </p>
                    <p class = "subtotal_amt"> &#8377; <%= CartItem.show_cart_item(cart.id).sum(:temp_price) %></p>
                  </div>
                  <div class = "Checkout_clear">
                    <%= link_to "Checkout >",cart_items_path,class: "Checkout_button"  %>
                    <%= link_to "ClearCart",destroy_all_cart_items_path,method:"delete",class:"clearCart"%>
                  </div>
              </div>
            </div>
        <% end %>
  </div>
</div>

<script>
  var category_header = document.getElementById("Categories_link");
  var category_links = category_header.getElementsByClassName("SideNave_categories_link");
  for (var i = 0; i < category_links.length; i++) {
    btns[i].addEventListener("click", function() {
    var current = document.getElementsByClassName("active");
    current[0].className = current[0].className.replace(" active", "");
    this.className += " active";
    });
  }
</script>
